<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#0a1929">
    <title>{% block title %}Mobil ERP{% endblock %} — OFİSBİR</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0a1929; color: #e0f7fa; min-height: 100vh; padding-bottom: 72px; -webkit-tap-highlight-color: transparent; }
        /* Üst bar: uygulama adı + arama, profil, bildirim */
        .mobile-header { padding: 12px 16px; background: #0f2537; border-bottom: 1px solid #1e3a50; display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; }
        .mobile-header .app-title { font-size: 20px; font-weight: 700; color: #e0f7fa; letter-spacing: 0.5px; }
        .mobile-header .header-actions { display: flex; align-items: center; gap: 16px; }
        .mobile-header .header-actions a { color: #90a4ae; text-decoration: none; font-size: 18px; position: relative; }
        .mobile-header .header-actions a:hover { color: #4fc3f7; }
        .mobile-header .header-actions .badge { position: absolute; top: -4px; right: -4px; background: #3b82f6; color: #fff; font-size: 10px; min-width: 16px; height: 16px; border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        /* Kritik şerit – sarı sol çizgi (görseldeki gibi) */
        .strip { background: #1e3a50; color: #e0f7fa; padding: 12px 14px 12px 16px; font-size: 13px; font-weight: 600; display: flex; align-items: center; gap: 10px; flex-shrink: 0; border-left: 4px solid #eab308; }
        .strip.kritik { border-left-color: #eab308; background: rgba(234,179,8,0.12); }
        .strip.ok { border-left-color: #22c55e; background: rgba(34,197,94,0.12); }
        .strip a { color: inherit; text-decoration: none; }
        .strip i { color: #eab308; }
        .strip.ok i { color: #22c55e; }
        .page-header { padding: 12px 14px; background: #0f2537; border-bottom: 1px solid #1e3a50; display: flex; align-items: center; gap: 10px; }
        .page-header h1 { font-size: 18px; font-weight: 700; }
        .search-wrap { padding: 8px 14px; background: #0a1929; }
        .search-wrap input { width: 100%; padding: 10px 14px; border-radius: 8px; border: 1px solid #2d4060; background: #1e3a50; color: #e0f7fa; font-size: 14px; }
        .search-wrap input::placeholder { color: #78909c; }
        .content { padding: 14px; padding-bottom: 20px; }
        /* Alt menü – 6 sekme */
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; height: 64px; background: #0f2537; border-top: 1px solid #1e3a50; display: flex; justify-content: space-around; align-items: center; z-index: 1000; padding-bottom: env(safe-area-inset-bottom); }
        .bottom-nav a { display: flex; flex-direction: column; align-items: center; justify-content: center; color: #90a4ae; text-decoration: none; font-size: 9px; padding: 6px 4px; min-width: 52px; border-radius: 8px; transition: all 0.2s; }
        .bottom-nav a i { font-size: 20px; margin-bottom: 2px; }
        .bottom-nav a.active { color: #4fc3f7; background: rgba(79,195,247,0.2); }
        .bottom-nav a:active { opacity: 0.8; }
        .card { background: #1e3a50; border-radius: 10px; padding: 14px; margin-bottom: 12px; border: 1px solid #2d4060; }
        .card h3 { color: #4fc3f7; font-size: 12px; margin-bottom: 8px; }
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 6px; padding: 10px 16px; border-radius: 8px; font-size: 14px; font-weight: 600; text-decoration: none; border: none; cursor: pointer; }
        .btn-block { width: 100%; }
        .btn-green { background: #22c55e; color: #fff; }
        .btn-red { background: #ef4444; color: #fff; }
        .btn-orange { background: #f97316; color: #fff; }
        .btn-blue { background: #3b82f6; color: #fff; }
        .risk-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 6px; }
        .risk-dot.stabil { background: #22c55e; }
        .risk-dot.dikkat { background: #eab308; }
        .risk-dot.kritik { background: #ef4444; }
        .list-item { padding: 14px; background: #1e3a50; border-radius: 8px; margin-bottom: 8px; border-left: 4px solid #2d4060; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 8px; }
        .list-item.kritik { border-left-color: #ef4444; }
        .list-item.dikkat { border-left-color: #eab308; }
        .list-item.stabil { border-left-color: #22c55e; }
        .swipe-actions { display: flex; gap: 6px; flex-shrink: 0; }
        .swipe-actions a, .swipe-actions button { padding: 8px 12px; border-radius: 6px; font-size: 12px; text-decoration: none; border: none; cursor: pointer; display: inline-flex; align-items: center; gap: 4px; }
        .tabs { display: flex; border-bottom: 1px solid #2d4060; margin-bottom: 12px; overflow-x: auto; }
        .tabs a { padding: 10px 16px; color: #90a4ae; text-decoration: none; font-size: 13px; white-space: nowrap; border-bottom: 3px solid transparent; }
        .tabs a.active { color: #4fc3f7; border-bottom-color: #4fc3f7; }
        .toast { position: fixed; bottom: 88px; left: 50%; transform: translateX(-50%); background: #1e3a50; color: #e0f7fa; padding: 10px 18px; border-radius: 8px; font-size: 13px; z-index: 9999; box-shadow: 0 4px 20px rgba(0,0,0,0.4); display: none; }
        /* Hızlı aksiyon grid (görseldeki frosted glass butonlar) */
        .action-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px; }
        .action-tile { background: rgba(30,58,80,0.85); backdrop-filter: blur(8px); border: 1px solid rgba(45,64,96,0.8); border-radius: 12px; padding: 20px; text-align: center; text-decoration: none; color: #e0f7fa; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100px; transition: transform 0.15s, box-shadow 0.15s; }
        .action-tile:active { transform: scale(0.98); }
        .action-tile i { font-size: 28px; margin-bottom: 10px; color: #4fc3f7; }
        .action-tile span { font-size: 12px; font-weight: 600; line-height: 1.3; }
    </style>
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Üst bar: ERP başlığı + arama, profil, bildirim -->
    <header class="mobile-header">
        <span class="app-title">ERP</span>
        <div class="header-actions">
            <a href="{{ url_for('mobile.musteriler') }}" title="Ara"><i class="fa fa-search"></i></a>
            <a href="{{ url_for('mobile.dashboard') }}#kritik" title="Bildirimler" class="notif-icon">
                <i class="fa fa-bell"></i>
                {% if strip and strip.kritik_say > 0 %}<span class="badge">{{ strip.kritik_say }}</span>{% endif %}
            </a>
            <a href="/auth/profile" title="Profil"><i class="fa fa-user"></i></a>
        </div>
    </header>

    <!-- Kritik uyarı şeridi (sarı vurgu – görseldeki gibi) -->
    {% if strip and strip.kritik_say > 0 %}
    <a href="{{ url_for('mobile.dashboard') }}#kritik" class="strip kritik">
        <i class="fa fa-exclamation-triangle"></i>
        <span>KRİTİK: {{ strip.kritik_say }} müşteri gecikmiş — {{ "{:,.0f}".format(strip.kritik_toplam).replace(",", " ") }} ₺</span>
    </a>
    {% else %}
    <div class="strip ok"><i class="fa fa-check-circle"></i> Kritik gecikme yok</div>
    {% endif %}

    {% block header %}{% endblock %}

    {% block search %}{% endblock %}

    <main class="content">
        {% block content %}{% endblock %}
    </main>

    <!-- Alt menü – 6 ana sekme -->
    <nav class="bottom-nav">
        <a href="{{ url_for('mobile.dashboard') }}" class="{% if request.endpoint == 'mobile.dashboard' %}active{% endif %}"><i class="fa fa-tachometer-alt"></i> Dashboard</a>
        <a href="{{ url_for('mobile.musteriler') }}" class="{% if request.endpoint in ('mobile.musteriler', 'mobile.musteri_detay') %}active{% endif %}"><i class="fa fa-users"></i> Müşteriler</a>
        <a href="{{ url_for('mobile.tahsilat') }}" class="{% if request.endpoint == 'mobile.tahsilat' %}active{% endif %}"><i class="fa fa-wallet"></i> Tahsilat</a>
        <a href="{{ url_for('mobile.operasyon') }}" class="{% if request.endpoint == 'mobile.operasyon' %}active{% endif %}"><i class="fa fa-box"></i> Operasyon</a>
        <a href="{{ url_for('mobile.yonetim') }}" class="{% if request.endpoint == 'mobile.yonetim' %}active{% endif %}"><i class="fa fa-chart-pie"></i> Yönetim</a>
        <a href="{{ url_for('mobile.ilan_robotu') }}" class="{% if request.endpoint == 'mobile.ilan_robotu' %}active{% endif %}"><i class="fa fa-bullhorn"></i> İlan Robotu</a>
    </nav>

    <div class="toast" id="toast"></div>
    {% block extra_js %}{% endblock %}
</body>
</html>
