{% extends "layout.html" %}

{% block page_title %}MÃ¼ÅŸteri Aktar - Excel{% endblock %}

{% block content %}
<div class="card-erp" style="max-width:700px;margin:20px auto;">
  <h3>Excel'den MÃ¼ÅŸteri Aktar</h3>
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="import-flash-wrap" style="margin-bottom:16px;">
      {% for category, message in messages %}
      <div class="import-flash import-flash-{{ category }}">
        <span class="import-flash-icon">{% if category == 'success' %}âœ“{% elif category == 'danger' %}âœ•{% else %}âš {% endif %}</span>
        <div class="import-flash-text">{{ message }}</div>
      </div>
      {% endfor %}
    </div>
    <style>
      .import-flash-wrap { display: block; }
      .import-flash { display: flex; align-items: flex-start; gap: 12px; padding: 14px 18px; border-radius: 8px; font-size: 14px; margin-bottom: 10px; }
      .import-flash-icon { font-size: 20px; font-weight: bold; flex-shrink: 0; }
      .import-flash-success { background: rgba(34,197,94,0.2); border: 1px solid #22c55e; color: #22c55e; }
      .import-flash-danger { background: rgba(239,68,68,0.2); border: 1px solid #ef4444; color: #ef4444; }
      .import-flash-warning { background: rgba(234,179,8,0.2); border: 1px solid #eab308; color: #eab308; }
      .import-flash-info { background: rgba(79,195,247,0.2); border: 1px solid #4fc3f7; color: #4fc3f7; }
      .import-flash-text { flex: 1; }
    </style>
    {% endif %}
  {% endwith %}
  <p style="color:#90a4ae; margin-bottom:14px;">Ä°lk satÄ±r sÃ¼tun baÅŸlÄ±ÄŸÄ± olmalÄ±. Desteklenen sÃ¼tun adlarÄ± (en az biri zorunlu):</p>
  <ul style="color:#b0bec5; font-size:13px; margin-bottom:14px; padding-left:20px;">
    <li><strong>MÃ¼ÅŸteri adÄ±:</strong> Ad, Unvan, Firma, Name, MÃ¼ÅŸteri AdÄ±</li>
    <li>E-posta, Telefon, Adres, Vergi No (opsiyonel)</li>
  </ul>
  <p style="font-size:12px; color:#78909c;">Dosya formatÄ±: .xlsx (Ã¶nerilir)</p>

  <form method="post" action="{{ url_for('musteriler.import_excel') }}" enctype="multipart/form-data" id="importForm">
    <div style="margin-bottom:14px;">
      <input type="file" name="file" accept=".xlsx,.xls" required style="padding:8px;" id="importFile">
    </div>
    <div id="importActions">
      <button class="btn-erp" type="submit" id="importBtn">ğŸ“‚ Ä°Ã§e Aktar</button>
      <a href="{{ url_for('musteriler.index') }}" class="btn-erp btn-erp-sm" style="background:#6b7280;">Geri</a>
    </div>
    <div id="importLoading" style="display:none; margin-top:12px; padding:12px; background:rgba(79,195,247,0.15); border:1px solid #4fc3f7; border-radius:8px; color:#4fc3f7;">
      <span class="import-spinner">â³</span> AktarÄ±lÄ±yorâ€¦ LÃ¼tfen bekleyin. (Sayfa yÃ¶nlendirilince biter.)
    </div>
  </form>
</div>
<script>
document.getElementById('importForm').addEventListener('submit', function() {
  var btn = document.getElementById('importBtn');
  var loading = document.getElementById('importLoading');
  if (btn && loading) {
    btn.disabled = true;
    btn.textContent = 'AktarÄ±lÄ±yorâ€¦';
    loading.style.display = 'block';
  }
});
</script>
{% endblock %}

